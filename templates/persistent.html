<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– Persistent Bluesky Bot</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 800px; margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px; padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #333; font-size: 28px; margin-bottom: 5px; }
        .header p { color: #666; font-size: 14px; }
        .alert { padding: 15px; margin-bottom: 20px; border-radius: 10px; font-size: 14px; }
        .alert-info { background-color: #e0f7fa; color: #00bcd4; border: 1px solid #00bcd4; }
        .status-box { background-color: #f0f4f8; border-left: 5px solid #667eea; margin-bottom: 20px; padding: 15px; border-radius: 10px; }
        .detailed-progress { background: #fff; margin-bottom: 20px; border-radius: 10px; display: flex; flex-wrap: wrap; }
        .progress-item { width: 50%; padding: 10px 15px; border-bottom: 1px solid #eee; }
        .progress-item:nth-child(even) { border-left: 1px solid #eee; }
        .progress-item label { display: block; font-size: 12px; color: #999; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-weight: bold; margin-bottom: 5px; color: #555; }
        input[type="text"], input[type="password"], input[type="number"], textarea {
            width: 100%; padding: 10px; border: 1px solid #ddd;
            border-radius: 5px; font-size: 14px;
        }
        textarea { resize: vertical; }
        .form-section {
            padding: 20px; margin-bottom: 20px; border-radius: 10px;
            background-color: #f7f7f7; border: 1px solid #eee;
        }
        .form-section h3 { margin-bottom: 15px; color: #667eea; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .button-group button {
            padding: 10px 20px; margin-right: 10px; border: none;
            border-radius: 5px; cursor: pointer; font-weight: bold; color: white;
        }
        #queueTaskButton { background-color: #28a745; }
        #stopTaskButton { background-color: #dc3545; }
        #resumeTaskButton { background-color: #ffc107; }
        #viewProgressButton { background-color: #17a2b8; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Persistent Bluesky Bot</h1>
            <p>ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©ØŒ Ø­ØªÙ‰ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©</p>
        </div>

        <div class="alert alert-info">
            <p><strong>ØªÙ†ÙˆÙŠÙ‡:</strong> ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¨ÙˆØª Ø¨Ù…Ø¬Ø±Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©". ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… <strong>App Password</strong> ÙˆÙ„ÙŠØ³ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©.</p>
        </div>

        <div class="status-box">
            <h3 style="color:#667eea;">Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©</h3>
            <p><strong>Ø­Ø§Ù„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„:</strong> <span id="runStatus">Idle</span></p>
            <p><strong>Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> <span id="currentTask">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ù…Ø©</span></p>
            <p><strong>ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©:</strong> <span id="lastUpdated">--</span></p>
        </div>

        <div class="detailed-progress">
            <h3 style="width:100%; padding:15px; margin:0; color:#764ba2;">ğŸ“Š Ø§Ù„ØªÙ‚Ø¯Ù…</h3>
            <div class="progress-item"><label>Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù…ÙÙ†Ø¬Ø²Ø©</label><span id="totalPostsProcessed">0</span></div>
            <div class="progress-item"><label>Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¨Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</label><span id="totalPostsQueued">0</span></div>
            <div class="progress-item"><label>Ø§Ù„Ù…ØªØ§Ø¨Ø¹ÙˆÙ†</label><span id="totalFollowers">0</span></div>
            <div class="progress-item"><label>Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙØ§Ø´Ù„Ø©</label><span id="failedRuns">0</span></div>
            <div class="progress-item"><label>Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­</label><span id="successRate">0%</span></div>
            <div class="progress-item"><label>Ù…Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„</label><span id="sessionUptime">--</span></div>
            <div class="progress-item"><label>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</label><span id="remainingTime">--</span></div>
            <div class="progress-item"><label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¯ÙˆØ¯</label><span id="totalMentionsSent">0</span></div>
        </div>

        <form id="botForm">
            <div class="form-section">
                <h3>Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
                <div class="form-group">
                    <label for="bluesky_handle">Ø­Ø³Ø§Ø¨ Ø¨Ù„ÙˆØ³ÙƒØ§ÙŠ</label>
                    <input type="text" id="bluesky_handle" placeholder="yourname.bsky.social">
                </div>
                <div class="form-group">
                    <label for="bluesky_password">ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</label>
                    <input type="password" id="bluesky_password" placeholder="App Password">
                </div>
            </div>

            <div class="form-section">
                <h3>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†Ø´ÙˆØ±</h3>
                <div class="form-group">
                    <label for="post_url_1">Post URL</label>
                    <input type="text" id="post_url_1" placeholder="https://bsky.app/profile/user/post/...">
                </div>
            </div>

            <div class="form-section">
                <h3>Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (10)</h3>
                <textarea id="message_template_1" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 1"></textarea>
                <textarea id="message_template_2" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 2"></textarea>
                <textarea id="message_template_3" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 3"></textarea>
                <textarea id="message_template_4" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 4"></textarea>
                <textarea id="message_template_5" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 5"></textarea>
                <textarea id="message_template_6" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 6"></textarea>
                <textarea id="message_template_7" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 7"></textarea>
                <textarea id="message_template_8" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 8"></textarea>
                <textarea id="message_template_9" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 9"></textarea>
                <textarea id="message_template_10" rows="2" placeholder="Ø±Ø³Ø§Ù„Ø© 10"></textarea>
            </div>

            <div class="form-section">
                <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
                <div class="form-group">
                    <label for="processing_type">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</label>
                    <select id="processing_type">
                        <option value="reposts">Ø¥Ø¹Ø§Ø¯Ø© Ù†Ø´Ø± + Ø±Ø¯ÙˆØ¯</option>
                        <option value="replies">Ø±Ø¯ÙˆØ¯ ÙÙ‚Ø·</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="min_delay">Ø£Ù‚Ù„ ØªØ£Ø®ÙŠØ± (Ø«ÙˆØ§Ù†ÙŠ)</label>
                    <input type="number" id="min_delay" value="180">
                </div>
                <div class="form-group">
                    <label for="max_delay">Ø£Ù‚ØµÙ‰ ØªØ£Ø®ÙŠØ± (Ø«ÙˆØ§Ù†ÙŠ)</label>
                    <input type="number" id="max_delay" value="300">
                </div>
            </div>

            <div class="button-group">
                <button type="button" id="queueTaskButton" onclick="queueTask()">âœ… Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©</button>
                <button type="button" id="stopTaskButton" onclick="stopTask()">ğŸ›‘ Ø¥ÙŠÙ‚Ø§Ù</button>
                <button type="button" id="resumeTaskButton" onclick="resumeTask()">â–¶ï¸ Ø§Ø³ØªØ¦Ù†Ø§Ù</button>
                <button type="button" id="viewProgressButton" onclick="updateStatus()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
            </div>
            <div id="taskQueueStatus" style="margin-top:20px; font-weight:bold; color:#00bcd4;"></div>
        </form>
    </div>

    <script>
        function getMessageTemplates() {
            const msgs=[]; for(let i=1;i<=10;i++){ 
                let val=document.getElementById('message_template_'+i).value.trim();
                if(val) msgs.push(val);
            } return msgs;
        }
        function queueTask() {
            fetch('/queue_task',{method:'POST',headers:{'Content-Type':'application/json'},
              body:JSON.stringify({
                post_urls:[document.getElementById('post_url_1').value],
                message_templates:getMessageTemplates(),
                bluesky_handle:document.getElementById('bluesky_handle').value,
                bluesky_password:document.getElementById('bluesky_password').value,
                processing_type:document.getElementById('processing_type').value,
                min_delay:parseInt(document.getElementById('min_delay').value),
                max_delay:parseInt(document.getElementById('max_delay').value)
              })})
            .then(r=>r.json()).then(d=>{
                document.getElementById('taskQueueStatus').textContent='âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©';
                updateStatus();
            }).catch(e=>{
                document.getElementById('taskQueueStatus').textContent='âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©';
            });
        }
        function stopTask(){ fetch('/stop_task').then(r=>r.json()).then(d=>{
            document.getElementById('taskQueueStatus').textContent='ğŸ›‘ Ø§Ù„Ù…Ù‡Ù…Ø© ØªÙˆÙ‚ÙØª'; updateStatus();
        });}
        function resumeTask(){ fetch('/resume_task').then(r=>r.json()).then(d=>{
            document.getElementById('taskQueueStatus').textContent='â–¶ï¸ Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ø³ØªØ¤Ù†ÙØª'; updateStatus();
        });}
        function updateStatus(){ fetch('/detailed_progress').then(r=>r.json()).then(data=>{
            document.getElementById('runStatus').textContent=data.runtime_stats.status||'Idle';
            document.getElementById('currentTask').textContent=data.runtime_stats.current_task||'--';
            document.getElementById('lastUpdated').textContent=new Date().toLocaleTimeString();
            document.getElementById('totalPostsProcessed').textContent=data.bot_progress.completed_runs;
            document.getElementById('totalPostsQueued').textContent=data.bot_progress.total_bot_runs;
            document.getElementById('totalFollowers').textContent=data.bot_progress.total_followers||'0';
            document.getElementById('failedRuns').textContent=data.bot_progress.failed_runs;
            document.getElementById('successRate').textContent=(data.bot_progress.success_rate*100).toFixed(2)+'%';
            document.getElementById('sessionUptime').textContent=data.runtime_stats.session_uptime;
            document.getElementById('remainingTime').textContent=data.runtime_stats.current_task_runtime||'0s';
            document.getElementById('totalMentionsSent').textContent=data.bot_progress.total_mentions_sent||'0';
        }).catch(e=>{
            document.getElementById('runStatus').textContent='âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«';
        });}
        setInterval(updateStatus,5000); window.onload=updateStatus;
    </script>
</body>
    </html>
